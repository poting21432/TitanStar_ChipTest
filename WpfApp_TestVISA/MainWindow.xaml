<Window x:Class="WpfApp_TestOmron.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfApp_TestOmron" 
        xmlns:wpf="clr-namespace:Support.Wpf;assembly=Support"
        mc:Ignorable="d" Background="{StaticResource SCB_ChartBackground_Medium}"
        Title="立捷頻譜儀 讀寫測試工具" FontSize="25" Loaded="Window_Loaded" Height="1050">
    <Window.DataContext>
        <local:Model_Main/>
    </Window.DataContext>
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary x:Name="Resource_BlueEx" Source="/WpfApp.Themes.BlueEX;component/BlueEx/Pack.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <StackPanel Orientation="Horizontal">
        <StackPanel Margin="10">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="VISA裝置" Width="120"/>
                <ComboBox ItemsSource="{Binding VISA_Devices}" FontSize="25" Width="410" Margin="10 0"/>
                <Button Content="刷新" IsEnabled="{Binding EnConnect}" Command="{Binding Command_Connect}" Width="100" FontSize="25"/>
                <Button Content="{Binding TextConnect}" IsEnabled="{Binding EnConnect}" Command="{Binding Command_Connect}" Width="100" Margin="10 0" FontSize="25"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="0 10">
                <TextBlock Text="寫入數據" Width="120"/>
                <TextBox Text="{Binding WriteData}" Width="520" Margin="10 0"/>
                <Button Content="寫入" Width="100" FontSize="25" Command="{Binding Command_Write}"/>
            </StackPanel>
            <wpf:UserControl_Log Height="400" Margin="0 10" Width="800"/>
            <DataGrid Margin="0 20" AutoGenerateColumns="False" Width="800" FontSize="20" Style="{StaticResource StyleDataGrid_RowSelection}"
                IsReadOnly="True" ItemsSource="{Binding ProductRecords}" Height="440" CanUserSortColumns="True" CanUserAddRows="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" FontSize="20" Binding="{Binding ID}" Width="50"/>
                    <DataGridTextColumn Header="開始時間" FontSize="20" Binding="{Binding Time}" Width="140"/>
                    <DataGridTextColumn Header="結束時間" FontSize="20" Binding="{Binding Time}" Width="140"/>
                    <DataGridTextColumn Header="燒錄" FontSize="20" Binding="{Binding BurnCheck}"  Width="40"/>
                    <DataGridTextColumn Header="3V-uA" FontSize="20" Binding="{Binding Test3VuA, StringFormat=F1}"  Width="70"/>
                    <DataGridTextColumn Header="天線" FontSize="20" Binding="{Binding TestAntenna, StringFormat=F1}"  Width="70"/>
                    <DataGridTextColumn Header="5V-mA" FontSize="20" Binding="{Binding Test5VmA, StringFormat=F1}"  Width="70"/>
                    <DataGridTextColumn Header="DIO" FontSize="20" Binding="{Binding DIOCheck}"  Width="40"/>
                    <DataGridTextColumn Header="開關" FontSize="20" Binding="{Binding SwitchCheck}"  Width="40"/>
                    <DataGridTextColumn Header="磁簧" FontSize="20" Binding="{Binding ReedCheck}"  Width="40"/>
                    <DataGridTextColumn Header="低電壓" FontSize="20" Binding="{Binding LowVCheck}"  Width="55"/>
                </DataGrid.Columns>
            </DataGrid>

        </StackPanel>
        <StackPanel>
            <StackPanel Orientation="Horizontal" Margin="10">
                <Button Content="跳過目前步驟" FontSize="30" Width="240" Height="50"/>
                <Button Content="取消生產" FontSize="30" Width="240" Height="50" Margin="10 0"/>
            </StackPanel>
            <TextBlock Text="左側選擇產品指定測試項目" FontSize="35" Margin="10 0"/>
            <StackPanel Orientation="Horizontal" Margin="10">
                <ComboBox ItemsSource="{Binding AssignedTests}" SelectedItem="{Binding AssignedTest}"
                          Width="320" Margin="10 0"/>
                <Button Content="開始測試" Height="40" Width="150"/>
            </StackPanel>
            <GroupBox Header="作業流程" Width="500"
                FontSize="35" Margin="5 10"  Grid.Column="0">
                <ItemsControl ItemsSource="{Binding StepsData}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate DataType="{x:Type wpf:StepData}">
                            <StackPanel Orientation="Horizontal" Height="50" VerticalAlignment="Center">
                                <wpf:UserControl_StatusIndicator FontSize="20" Width="25" Height="25" Status="{Binding DataContext.Status, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContentPresenter}}"
                        VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                <TextBlock Text="{Binding Title}" FontSize="30" Foreground="{Binding ColorBrush}" Margin="5"/>
                                <TextBlock Text="{Binding TimeTag}" FontSize="25" VerticalAlignment="Center" Width="90" Foreground="{Binding ColorBrush}" Margin="5"/>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </GroupBox>
        </StackPanel>
        
    </StackPanel>
   
</Window>
